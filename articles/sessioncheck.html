<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to sessioncheck • sessioncheck</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to sessioncheck">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sessioncheck</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/sessioncheck.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/why-check-the-r-session.html">Why is it important to check the R session?</a></li>
    <li><a class="dropdown-item" href="../articles/customizing-sessioncheck.html">Customizing sessioncheck() behavior</a></li>
    <li><a class="dropdown-item" href="../articles/individual-checks.html">Individual session check functions</a></li>
    <li><a class="dropdown-item" href="../articles/s3-classes.html">S3 classes and methods</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/djnavarro/sessioncheck/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to sessioncheck</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/djnavarro/sessioncheck/blob/v0.1/vignettes/articles/sessioncheck.Rmd" class="external-link"><code>vignettes/articles/sessioncheck.Rmd</code></a></small>
      <div class="d-none name"><code>sessioncheck.Rmd</code></div>
    </div>

    
    
<p>The goal of <strong>sessioncheck</strong> is to provide a simple tool
that can be called at the top of a script, and produce warnings or
errors if it detects signs that the script is not being executed in a
clean R session:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># include this as the first line of a script</span></span>
<span><span class="co"># as a safer alternative to using rm(list=ls())</span></span>
<span><span class="fu">sessioncheck</span><span class="fu">::</span><span class="fu"><a href="../reference/sessioncheck.html">sessioncheck</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="who-is-sessioncheck-for">Who is sessioncheck for?<a class="anchor" aria-label="anchor" href="#who-is-sessioncheck-for"></a>
</h2>
<p>The intended user for <strong>sessioncheck</strong> is a beginner or
intermediate level R user who wants to take reasonable precautions to
ensure that their analysis scripts execute reproducibly, but is not
looking for a full-featured solution that might require substantial time
investment to learn and deploy.</p>
</div>
<div class="section level2">
<h2 id="why-is-sessioncheck-useful">Why is sessioncheck useful?<a class="anchor" aria-label="anchor" href="#why-is-sessioncheck-useful"></a>
</h2>
<p>A common practice when writing R scripts is to include a snippet of
code like <code>rm(list = ls())</code> at the top of the script. The
reason people do this is for reproducibility purposes, to ensure that
the script is run in the context of a “clean” R session.</p>
<p>Unfortunately, while the goal is a good one the solution is not.</p>
<p>The problem with the “traditional” approach is that the only thing it
does is remove objects from the global environment. If your goal is to
ensure that the R session is clean, this isn’t sufficient. The reason
it’s not enough is that the state of an R session is defined by a
<em>lot</em> of different things, and the objects in the global
environment form a very small part of that state. Yes, using
<code><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm()</a></code> to clear the global environment will “clean” this
specific aspect to the R session state, but it has no effect on any of
the other things. What’s worse, the <code><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm()</a></code> approach can
create false confidence: if users rely on <code><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm()</a></code> as an
“automated” method for cleaning the session state, they may end up
executing scripts in a profoundly irreproducible way, never noticing
that something bad has happened. This is, to put it mildly, not
ideal.</p>
<p>Because of this, a better practice is to <strong>restart the R
session</strong> immediately before running the script. By running the
script in a fresh R session, you’re much less likely to encounter these
issues. By extension, the reason for including a call to
<code><a href="../reference/sessioncheck.html">sessioncheck()</a></code> at the top of a script is not to try to
clean the R session (which is very hard to automate). Instead, what it
does is <strong>prompt the user</strong> to take appropriate action if
potential issues are detected. For additional background, see the
article on <a href="https://sessioncheck.djnavarro.net/articles/why-check-the-r-session.html">why
session checking is useful</a>.</p>
</div>
<div class="section level2">
<h2 id="what-does-sessioncheck-do">What does sessioncheck do?<a class="anchor" aria-label="anchor" href="#what-does-sessioncheck-do"></a>
</h2>
<p>The main function in <strong>sessioncheck</strong> is
<code><a href="../reference/sessioncheck.html">sessioncheck()</a></code>, which examines the state of the R session
and informs the user if potential issues are detected. The behavior of
<code><a href="../reference/sessioncheck.html">sessioncheck()</a></code> is <a href="https://sessioncheck.djnavarro.net/articles/customizing-sessioncheck.html">customizable</a>,
allowing the user to make decisions about what criteria should be used
to decide if an R session is “dirty”.</p>
<p>For the purposes of this article we will stick to the default checks.
The simplest of these examines the contents of the global environment,
very much in line with the traditional method of inserting
<code>rm(list=ls())</code> into the top of a script. At the moment there
is nothing in the global environment associated with this document, so
it is considered “clean”. When <code><a href="../reference/sessioncheck.html">sessioncheck()</a></code> is called in
a clean state, no message is printed:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sessioncheck</span><span class="fu">::</span><span class="fu"><a href="../reference/sessioncheck.html">sessioncheck</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>By default, <code><a href="../reference/sessioncheck.html">sessioncheck()</a></code> adheres to the R convention
that variables starting with a period are hidden variables, and does not
report any issues if the session contains a variable like
<code>.Random.seed</code> or <code>.Last.value</code>. This can be
customized, but for the purposes of this article we’ll just look at the
default behavior:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">visible_1</span> <span class="op">&lt;-</span> <span class="st">"this will get detected"</span></span>
<span><span class="va">visible_2</span> <span class="op">&lt;-</span> <span class="st">"so will this"</span></span>
<span><span class="va">.hidden_1</span> <span class="op">&lt;-</span> <span class="st">"but this will not"</span></span>
<span></span>
<span><span class="fu">sessioncheck</span><span class="fu">::</span><span class="fu"><a href="../reference/sessioncheck.html">sessioncheck</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Session check results:</span></span>
<span><span class="co">#&gt; - Objects in global environment: visible_1, visible_2</span></span>
<span><span class="co">#&gt; - Attached packages: [no issues detected]</span></span>
<span><span class="co">#&gt; - Attached environments: [no issues detected]</span></span></code></pre></div>
<p>The first line of this output indicates that the script has detected
<code>visible_1</code> and <code>visible_2</code> in the global
environment, and issues a warning to suggest that the R session may be
contaminated. This can be upgraded to an error if so desired, to ensure
that the script will refuse to run if the R session is not deemed to be
clean:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sessioncheck</span><span class="fu">::</span><span class="fu"><a href="../reference/sessioncheck.html">sessioncheck</a></span><span class="op">(</span>action <span class="op">=</span> <span class="st">"error"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Session check results:</span></span>
<span><span class="co">#&gt; - Objects in global environment: visible_1, visible_2</span></span>
<span><span class="co">#&gt; - Attached packages: [no issues detected]</span></span>
<span><span class="co">#&gt; - Attached environments: [no issues detected]</span></span></code></pre></div>
<p>By default, <code><a href="../reference/sessioncheck.html">sessioncheck()</a></code> runs three checks, and
reports the results if any of the checks do not pass. The first one is
the global environment check discussed above. The second one checks for
packages that have been attached to the search path, usually via
<code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code> or <code><a href="https://rdrr.io/r/base/library.html" class="external-link">require()</a></code>. The third one checks
for other environments that have may have been attached, perhaps by
inadvertently calling the <code><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach()</a></code> function. This is
illustrated in the following example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span> <span class="co"># non-base packages are detected</span></span>
<span><span class="co">#&gt; Loading required package: knitr</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span> <span class="co"># base R packages are ignored</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>   <span class="co"># attached data frames are detected</span></span>
<span></span>
<span><span class="fu">sessioncheck</span><span class="fu">::</span><span class="fu"><a href="../reference/sessioncheck.html">sessioncheck</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Session check results:</span></span>
<span><span class="co">#&gt; - Objects in global environment: visible_1, visible_2</span></span>
<span><span class="co">#&gt; - Attached packages: knitr</span></span>
<span><span class="co">#&gt; - Attached environments: iris</span></span></code></pre></div>
<p>To an experienced R user it will likely be obvious that these three
checks are not sufficient to <strong>ensure</strong> that the R session
is clean (and indeed this is the reason why the behavior of
<code><a href="../reference/sessioncheck.html">sessioncheck()</a></code> can be customized). However, it does work
better than using <code>rm(list=ls())</code> and moreover, because most
cases in which a script is executed in a dirty R session are due to the
user previously executing code that loads packages or creates variables
in the global environment, it tends to work fairly well in practice.</p>
</div>
<div class="section level2">
<h2 id="further-reading">Further reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<p>For more information about the logic behind
<strong>sessioncheck</strong> and how its behavior can be modified, see
the following articles:</p>
<ul>
<li><a href="https://sessioncheck.djnavarro.net/articles/why-check-the-r-session.html">Why
session checking is useful</a></li>
<li><a href="https://sessioncheck.djnavarro.net/articles/customizing-sessioncheck.html">Customizing
sessioncheck()</a></li>
<li><a href="https://sessioncheck.djnavarro.net/articles/individual-checks.html">Individual
check functions</a></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Danielle Navarro.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
